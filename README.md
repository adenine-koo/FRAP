# FRAP
Analysis of FRAP movie generated by ND Stimulation (Nikon) in MATLAB

Step 1: frapROI2csv.m
1. User creates infile.txt file and timestamps.xlsx file corresponds to the movie frame. All movies from an experiment can be run together.
2. User selects/defines three regions of interest: nucleus, bleached ROI/doughnut and background when prompted
3. frapROI2csv.m reads nd2 file listed in infile.txt with nd2read.m and nd2finfo.m (modified from Joe Yeh, 2019) to create 3D matrix of pixel values for each movie, stabilise the bleached ROI with motioncorrect.m and tabulate the average pixel value for each ROI over the acquisition time in output.csv file
% Syntax for generating csv files and cropped ROI movie
frapROI2csv("infile.txt", buffer, 1);
% Syntax for generating csv files ONLY
frapROI2csv("infile.txt", buffer, 0);

Step 2: frapNorm.m
1. User creates infile2.txt file for a group of technical replicates of a certain experimental variable (genotype/condition).
2. frapNorm.m reads the csv outputs (from Step 1) for this group, normalises the ROI intensity (in full-scale method as developed by Giakoumakis et al. (2017)).
3. Normalised ROI intensities for each ROI was output in a single csv file to be used for graph plotting.
4. Repeat step 2 for the number of biological replicates x number of experimental variables.
% Syntax
frapNorm("infile2.txt", "outfile.csv");

Step 3: expfitting.m
1. User creates infile3.txt file with the sample name and the normalized csv outputs (from Step 2) for all of its biological replicates.
2. expfitting.m fits a single exponential curve ("a - b*exp(-c*x)") on each normalized recovery curve and uses the fitted curve to estimate t-half (In(2)./c) and mobile fraction (a), tabulates these two estimated values seperately in two output csv files according to its biological and technical replicate numbers (for subsequent statistical analysis).
3. expfitting.m also plots the fitted curve for each recovery curve, labelled with the two estimated parameters and the adjusted R-Square value, before saving the graph as a png output file (for ease to inspect the quality of curve fitting).

For detailed documentation, please check the comment section of the functions.
For help with selecting optimal motioncorrect buffer, read motioncorrectParameter.txt file

Sample nd2 file and timestamps.xlsx file are provided under the folder "Test file". Unzip nd2 file before used.
Sample outputs are also provided.
